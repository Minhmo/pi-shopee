<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shopee PTM - Mua b·∫±ng Pi</title>
  <script src="https://sdk.minepi.com/pi-sdk.js"></script>
  <style>
    body { font-family: 'Roboto', sans-serif; margin: 0; background-color: #f5f5f5; color: #333; }
    header { background-color: #ee4d2d; padding: 10px 15px; display: flex; justify-content: space-between; align-items: center; color: white; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    .logo { font-weight: bold; font-size: 20px; }
    .menu-icon { font-size: 28px; cursor: pointer; }
    
    .nav-menu { position: fixed; top: 0; left: -100%; width: 70%; height: 100%; background-color: #fff; display: flex; flex-direction: column; transition: 0.4s; z-index: 999; box-shadow: 2px 0 5px rgba(0,0,0,0.2); }
    .nav-menu.show { left: 0; }
    .nav-menu a { padding: 15px; text-decoration: none; color: #333; border-bottom: 1px solid #eee; font-weight: 500; }
    
    .user-info { background: #fff; padding: 12px 15px; margin: 10px; border-radius: 8px; font-size: 14px; border-left: 4px solid #ee4d2d; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
    
    .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(170px, 1fr)); gap: 12px; padding: 10px; }
    .product-card { background: #fff; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.08); transition: 0.3s; }
    .product-card:hover { transform: translateY(-3px); }
    .product-card img { width: 100%; height: 170px; object-fit: cover; }
    .product-info { padding: 10px; }
    .product-title { font-size: 14px; height: 40px; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; }
    .product-price { color: #ee4d2d; font-weight: bold; font-size: 16px; margin: 6px 0; }
    
    .buy-btn { display: block; background: #ee4d2d; color: white; text-align: center; padding: 9px 0; text-decoration: none; font-size: 13px; margin-top: 8px; border-radius: 4px; font-weight: 500; }
    .pay-pi-btn { display: block; background: linear-gradient(135deg, #673ab7, #9c27b0); color: white; border: none; width: 100%; padding: 10px 0; cursor: pointer; font-size: 13px; margin-top: 6px; border-radius: 4px; font-weight: bold; }
    
    .chat-btn { position: fixed; bottom: 20px; right: 20px; z-index: 1000; background: #25d366; border-radius: 50%; width: 56px; height: 56px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 12px rgba(0,0,0,0.3); text-decoration: none; }
  </style>
</head>
<body>

  <header>
    <div class="menu-icon" onclick="toggleMenu()">‚ò∞</div>
    <div class="logo">SHOPEE PTM</div>
    <div style="font-size: 22px;">üõí</div>
  </header>

  <nav class="nav-menu" id="navMenu">
    <div style="padding: 20px; background: #ee4d2d; color: #fff; font-weight: bold;">DANH M·ª§C</div>
    <a href="#" onclick="toggleMenu()">Trang ch·ªß</a>
    <a href="#" onclick="shareApp()">Chia s·∫ª App</a>
    <a href="#">Li√™n h·ªá h·ªó tr·ª£</a>
  </nav>

  <div class="user-info" id="user-display">ƒêang ki·ªÉm tra quy·ªÅn truy c·∫≠p Pi Network...</div>

  <div class="product-grid">
    <div class="product-card">
      <img src="https://via.placeholder.com/300x300/ee4d2d/ffffff?text=√Åo+Thun" alt="√Åo thun nam">
      <div class="product-info">
        <div class="product-title">√Åo thun nam Shopee Style</div>
        <div class="product-price">99.000ƒë</div>
        <a class="buy-btn" href="https://collshp.com/mediaplusptm13968?view=storefront" target="_blank">XEM TR√äN SHOPEE</a>
        <button class="pay-pi-btn" onclick="buyWithPi('√Åo thun nam Shopee Style', 1)">MUA B·∫∞NG PI (1 Pi)</button>
      </div>
    </div>

    <div class="product-card">
      <img src="https://via.placeholder.com/300x300/673ab7/ffffff?text=Gi√†y+Sneaker" alt="Gi√†y sneaker">
      <div class="product-info">
        <div class="product-title">Gi√†y Sneaker m·∫´u m·ªõi c·ª±c l·∫ßy</div>
        <div class="product-price">299.000ƒë</div>
        <a class="buy-btn" href="https://collshp.com/mediaplusptm13968?view=storefront" target="_blank">XEM TR√äN SHOPEE</a>
        <button class="pay-pi-btn" onclick="buyWithPi('Gi√†y Sneaker m·∫´u m·ªõi', 3)">MUA B·∫∞NG PI (3 Pi)</button>
      </div>
    </div>
  </div>

  <a href="https://wa.me/84974457838" class="chat-btn" target="_blank">
    <span style="color:white; font-size: 26px;">üí¨</span>
  </a>

  <script>
    const Pi = window.Pi;
    Pi.init({ version: "2.0", sandbox: true });

    function toggleMenu() {
      document.getElementById('navMenu').classList.toggle('show');
    }

    // ƒêƒÉng nh·∫≠p Pi
    Pi.authenticate(["username", "payments"], onIncompletePaymentFound)
    .then(function(auth) {
      console.log("ƒêƒÉng nh·∫≠p Pi th√†nh c√¥ng!", auth);
      document.getElementById('user-display').innerHTML = 
        "Ch√†o m·ª´ng <b>" + auth.user.username + "</b>!<br>B·∫°n ƒë√£ s·∫µn s√†ng mua h√†ng b·∫±ng Pi v√† ho√†n t·∫•t B∆∞·ªõc 10.";
    })
    .catch(function(error) {
      console.error("L·ªói authenticate:", error);
      document.getElementById('user-display').innerText = 
        "Vui l√≤ng m·ªü app trong Pi Browser ƒë·ªÉ ƒëƒÉng nh·∫≠p.";
    });

    function onIncompletePaymentFound(payment) {
      console.log("T√¨m th·∫•y giao d·ªãch ch∆∞a ho√†n t·∫•t:", payment);
      // C√≥ th·ªÉ th√™m logic x·ª≠ l√Ω thanh to√°n d·ªü dang ·ªü ƒë√¢y
    }

    // Thanh to√°n Pi
    function buyWithPi(productName, amount) {
      const paymentData = {
        amount: amount,
        memo: "Mua " + productName + " - PTM Shopee",
        metadata: { product: productName, orderId: "PTM-" + Date.now() }
      };

      const callbacks = {
        onReadyForServerApproval: function(paymentId) {
          console.log("Payment ID ready:", paymentId);
          // L√∫c n√†y Pi SDK ƒëang ch·ªù server Python c·ªßa b·∫°n approve
          // Code Python backend s·∫Ω t·ª± ƒë·ªông b·∫Øt l·∫•y paymentId n√†y
        },
        onReadyForServerCompletion: function(paymentId, txid) {
          console.log("Thanh to√°n th√†nh c√¥ng! TxID:", txid);
          alert("‚úÖ THANH TO√ÅN TH√ÄNH C√îNG!\n\nS·∫£n ph·∫©m: " + productName + "\nS·ªë Pi: " + amount + "\nTxID: " + txid + "\n\nC·∫£m ∆°n b·∫°n ƒë√£ h·ªó tr·ª£ x√°c minh B∆∞·ªõc 10!");
        },
        onCancel: function(paymentId) { console.log("ƒê√£ h·ªßy thanh to√°n"); },
        onError: function(error, payment) { 
          console.error("L·ªói:", error);
          alert("L·ªói thanh to√°n: " + error.message);
        }
      };

      Pi.createPayment(paymentData, callbacks);
    }

    function shareApp() {
      Pi.openShareDialog("Shopee PTM - Mua h√†ng b·∫±ng Pi", "App mua s·∫Øm Shopee Affiliate + Thanh to√°n Pi ƒë·∫ßu ti√™n tr√™n m·∫°ng Pi! Tr·∫£i nghi·ªám ngay!");
    }
  </script>
</body>
</html>